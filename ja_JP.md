# ipip6 Configuration Guide for OpenWrt (NTT + v6plus + Static IPv4)

[ğŸ‡ºğŸ‡¸ English](./README.md) | [ğŸ‡¨ğŸ‡³ ä¸­æ–‡](./zh_CN.md) | [ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª](./ja_JP.md)

---

ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã¯ã€NTTç³»ã®ISPï¼ˆ`v6plus` + **å›ºå®šIPv4**ï¼‰ã‚’åˆ©ç”¨ã™ã‚‹æ—¥æœ¬å›½å†…ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ã«ã€OpenWrtä¸Šã§ `ipip6` ãƒˆãƒ³ãƒãƒ«ã‚’æ§‹æˆã™ã‚‹ãŸã‚ã®è©³ç´°ãªæ‰‹é †ã‚’æä¾›ã—ã¾ã™ã€‚

æœ¬ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã¯ä»¥ä¸‹ã‚’å‰æã¨ã—ã¦ã„ã¾ã™ï¼š

- DHCPv6 Prefix Delegationï¼ˆPDï¼‰ã®åˆ©ç”¨  
- ISPã‹ã‚‰é…å¸ƒã•ã‚ŒãŸ `/56` ã®IPv6ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ï¼ˆ`/64`ã®å ´åˆã®å‹•ä½œã¯ä¸æ˜ï¼‰  
- ISPã‹ã‚‰æä¾›ã•ã‚ŒãŸBRã‚¢ãƒ‰ãƒ¬ã‚¹ãƒ»å›ºå®šIPv4ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒ»Interface IDã‚’ä½¿ç”¨ã—ã¦ `ipip6` ã‚’æ‰‹å‹•è¨­å®šã—ã€4in6ãƒˆãƒ³ãƒãƒ«ã‚’æœ‰åŠ¹ã«ã™ã‚‹

ğŸ“Œ ç›®çš„ã¯ã€OpenWrtãƒ«ãƒ¼ã‚¿ãƒ¼ã§IPv4 over IPv6æ¥ç¶šã‚’ç¢ºç«‹ã™ã‚‹ã“ã¨ã§ã™ã€‚

âœ… ã“ã®æ–¹æ³•ã¯ã€official-like OpenWrt ãŠã‚ˆã³ QWRT ã®ä¸¡æ–¹ã§æ­£å¸¸ã«å‹•ä½œã™ã‚‹ã“ã¨ãŒç¢ºèªã•ã‚Œã¦ã„ã¾ã™ã€‚

---

## è¨­å®šæ‰‹é †

### 1. ipip6ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

ä»¥ä¸‹ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ä½¿ã£ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ï¼š

> https://github.com/HiraokaHyperTools/openwrt-ipip6

ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¾Œã€**ãƒ«ãƒ¼ã‚¿ãƒ¼ã‚’å†èµ·å‹•**ã—ã¦ãã ã•ã„ã€‚

---

### 2. `wan6`ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®è¨­å®šï¼ˆDHCPv6 Clientï¼‰

- æ–°ã—ã„ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ä½œæˆ  
- ãƒ—ãƒ­ãƒˆã‚³ãƒ«ï¼š`DHCPv6 Client`  
- å¯¾å¿œã™ã‚‹ç‰©ç†ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¨Firewall Zoneã‚’å‰²ã‚Šå½“ã¦  
- ä¾‹ï¼š`240b:114:514:8100::/56` ã®ã‚ˆã†ãª `/56` ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ãŒå–å¾—ã§ãã‚‹ã‹ç¢ºèª

---

### 3. `ipip6`ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®è¿½åŠ 

- ãƒ—ãƒ­ãƒˆã‚³ãƒ«ï¼š`IPv4 over IPv6 (ipip6)`  
- OpenWrt 23.05ä»¥é™ã¯ `opkg` ã«ã‚ˆã‚Šå¯¾å¿œ

#### 3.1 åŸºæœ¬è¨­å®š

- Remote IPv6 addressï¼šä¾‹ï¼‰`2404:9200:225:100::65`  
- Local IPv4 addressï¼šISPãŒæä¾›ã™ã‚‹å›ºå®šIPv4ã‚¢ãƒ‰ãƒ¬ã‚¹  
- Local IPv6 addressï¼šå–å¾—ã—ãŸãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ + Interface ID  
  ä¾‹ï¼š`240b:114:514:8100:1919:0810:0893:0000`

#### 3.2 è©³ç´°è¨­å®š

- Tunnel linkï¼š`wan6`  
- Encapsulation limitï¼š`ignore`  
- IPv6 assignment lengthï¼š`64`  
- IPv6 suffixï¼š`::1919:0810:0893:0000`  
- IPv6 preferenceï¼š`0`  
- MTUï¼šãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ `1280`ã€æœ€å¤§ `1460` ã«è¨­å®šå¯èƒ½

#### 3.3 Firewallè¨­å®š

- é©åˆ‡ãªFirewall Zoneã«å‰²ã‚Šå½“ã¦  
- `DHCPv6`ã¨`Router Advertisement`ã¯ç„¡åŠ¹ã«è¨­å®š

---

### 4. LANã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®è¨­å®š

- IPv6 assignment lengthï¼š`/64`  
- IPv6 assignment hintï¼šä¾‹ï¼‰`1` ã¾ãŸã¯ `10`  
- ä¸¡æ–¹ã®IPv6ãƒ¢ãƒ¼ãƒ‰ã‚’ `server` ã«è¨­å®š

---

### 5. ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç¢ºèª

#### 5.1 ipip6ã‚¢ãƒ‰ãƒ¬ã‚¹ã®ç¢ºèª

- è¡¨ç¤ºä¾‹ï¼š`240b:114:514:8100::1/64`  
- å®Ÿéš›ã®ãƒˆãƒ³ãƒãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯SSHã§ç¢ºèªï¼š

  ```
  link/tunnel6 240b:114:514:8100:1919:0810:0893:0000 peer 2404:9200:225:100::65
  ```

#### 5.2 LANã‚¢ãƒ‰ãƒ¬ã‚¹ã®ç¢ºèª

assignment hintãŒ `1` ã®å ´åˆï¼šâ†’ `240b:114:514:8101::1/64`  
assignment hintãŒ `10` ã®å ´åˆï¼šâ†’ `240b:114:514:8110::1/64`

---

### 6. ãƒˆãƒ³ãƒãƒ«æ¥ç¶šã®ç¢ºèª

- `ipip6`ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«TX/RXãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚Œã°æˆåŠŸ  
- IPv4/IPv6æ¥ç¶šã¯å¤–éƒ¨ãƒ†ã‚¹ãƒˆã‚µã‚¤ãƒˆã§ç¢ºèªå¯èƒ½

---

## ã¾ã¨ã‚

**`ipip6` ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«ã¯ã€DHCPv6ã§å–å¾—ã—ãŸãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã¨ä¸€è‡´ã™ã‚‹IPv6ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚**

assignment hintã‚„IPv6 preferenceã‚’è¨­å®šã—ãªã„ã¨ï¼š

- `lan` ã« `8100::/64`
- `wan` ã« `8101::/64`

ã®ã‚ˆã†ãªç•°ãªã‚‹ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã€ãƒˆãƒ³ãƒãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒæ­£ã—ãç”Ÿæˆã•ã‚Œãšèªè¨¼ã«å¤±æ•—ã—ã¾ã™ã€‚

**å¯¾ç­–ï¼š**

- `lan` ã«IPv6 assignment hintã‚’è¨­å®š  
- `ipip6` ã«IPv6 preferenceã‚’è¨­å®š

æ­£ã—ã„ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒå–å¾—ã§ãã‚Œã°ã€ãƒˆãƒ³ãƒãƒ«ã¯æ­£å¸¸ã«ç¢ºç«‹ã•ã‚Œã¾ã™ã€‚

> ğŸ™ **è¬è¾**  
> åˆæœŸã®æ§‹æˆã¨ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã«å”åŠ›ã—ã¦ãã‚ŒãŸ [@missing233](https://github.com/missing233) ã•ã‚“ã«æ·±ãæ„Ÿè¬ã„ãŸã—ã¾ã™ã€‚  
> æœ¬ã‚¬ã‚¤ãƒ‰ã¯ã€ç§ãŸã¡ãŒå…±åŒã§è¨­å®šã—æ¤œè¨¼ã—ãŸå†…å®¹ã«åŸºã¥ã„ã¦ä½œæˆã•ã‚Œã¦ã„ã¾ã™ã€‚

> Keywords: OpenWrt, ipip6, IPv4 over IPv6, 4in6, v6plus, static IP, NTT, Japan, OpenWrt tunneling, å›ºå®šIPv4, IPv6ãƒˆãƒ³ãƒãƒ«